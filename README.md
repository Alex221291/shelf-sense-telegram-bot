# ShelfSense Telegram Bot

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API ShelfSense, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–∫–ª–∞–¥–∫–æ–π —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Ü–µ–Ω–Ω–∏–∫–∞–º–∏ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–¥–æ–∫ –ø–æ –≤—ã–∫–ª–∞–¥–∫–µ —Ç–æ–≤–∞—Ä–æ–≤
- üè∑Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–Ω–∏–∫–∞–º–∏ –∏ –∏—Ö –æ—à–∏–±–∫–∞–º–∏
- üîç –ü–æ–∏—Å–∫ –ø—É—Å—Ç–æ—Ç –≤ –º–µ—Ä—á-–≥—Ä—É–ø–ø–∞—Ö
- üìã –†–∞–±–æ—Ç–∞ —Å –º–µ—Ä—á-–≥—Ä—É–ø–ø–∞–º–∏
- üñ®Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å —Ü–µ–Ω–Ω–∏–∫–∞–º–∏
- ‚úÖ –û—Ç–º–µ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **NestJS** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **@nestjs/telegraf** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot API
- **Axios** - HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º API
- **TypeScript** - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd shelf-sense-telegram-bot
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:
```bash
cp env.example .env
```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
SHELF_SENSE_API_URL=http://localhost:8000
PORT=3000
NODE_ENV=development
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ñ–∞–π–ª `.env`

## üöÄ –ó–∞–ø—É—Å–∫

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
npm run start:dev
```

### –ü—Ä–æ–¥–∞–∫—à–Ω —Å–±–æ—Ä–∫–∞
```bash
npm run build
npm run start:prod
```

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/help` - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º

### –°–≤–æ–¥–∫–∏
- `/merchgroups` - –°–ø–∏—Å–æ–∫ –º–µ—Ä—á-–≥—Ä—É–ø–ø
- `/shelf_summary` - –°–≤–æ–¥–∫–∞ –ø–æ –≤—ã–∫–ª–∞–¥–∫–µ —Ç–æ–≤–∞—Ä–∞
- `/price_summary` - –°–≤–æ–¥–∫–∞ –ø–æ —Ü–µ–Ω–Ω–∏–∫–∞–º

### –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `/voids` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é –ø—É—Å—Ç–æ—Ç
- `/voids_group [ID]` - –ü—É—Å—Ç–æ—Ç—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ
- `/price_errors` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é –æ—à–∏–±–æ–∫
- `/price_errors_type [–¢–ò–ü]` - –û—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø—É
- `/price_errors_group [ID]` - –û—à–∏–±–∫–∏ –≤ –≥—Ä—É–ø–ø–µ

### –î–µ–π—Å—Ç–≤–∏—è
- `/generate_pdf` - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å PDF —Å —Ü–µ–Ω–Ω–∏–∫–∞–º–∏

## üîå API Endpoints

–ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ ShelfSense API:

- `GET /merchgroups` - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ä—á-–≥—Ä—É–ø–ø
- `GET /shelves/summary` - –°–≤–æ–¥–∫–∞ –ø–æ –≤—ã–∫–ª–∞–¥–∫–µ
- `GET /shelves/merchgroup/{group_id}/voids/tasks` - –ü—É—Å—Ç–æ—Ç—ã –≤ –≥—Ä—É–ø–ø–µ
- `GET /prices/summary` - –°–≤–æ–¥–∫–∞ –ø–æ —Ü–µ–Ω–Ω–∏–∫–∞–º
- `GET /prices/errortype/{error_type}/tasks` - –û—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø—É
- `GET /prices/merchgroup/{merch_group_id}/tasks` - –û—à–∏–±–∫–∏ –≤ –≥—Ä—É–ø–ø–µ
- `POST /tasks/action` - –û—Ç–º–µ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
- `GET /price_tags/pdf` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å —Ü–µ–Ω–Ω–∏–∫–∞–º–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ shelf-sense.types.ts    # –¢–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã API
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îî‚îÄ‚îÄ shelf-sense.dto.ts      # DTO –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ shelf-sense.service.ts  # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
‚îú‚îÄ‚îÄ telegram/
‚îÇ   ‚îú‚îÄ‚îÄ telegram.module.ts       # –ú–æ–¥—É–ª—å —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ telegram-bot.service.ts # –°–µ—Ä–≤–∏—Å —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞
‚îú‚îÄ‚îÄ app.module.ts                # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ main.ts                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
npm run test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ —Ä–µ–∂–∏–º–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
npm run test:watch

# –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏
npm run test:cov
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ë–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å:
- üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- üì± –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –±–æ—Ç–∞ –∫ —Ä–∞–±–æ—Ç–µ
- ‚ùå –û—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å API

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DTO
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

1. –°–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–æ–¥ –≤ `TelegramBotService`
2. –î–æ–±–∞–≤—å—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@Command('command_name')`
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å–ø—Ä–∞–≤–∫—É –≤ –º–µ—Ç–æ–¥–µ `helpCommand`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö API –º–µ—Ç–æ–¥–æ–≤

1. –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–æ–¥ –≤ `ShelfSenseService`
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã –≤ `shelf-sense.types.ts`
3. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å ShelfSense API
4. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ Telegram –±–æ—Ç–∞